# Create moderately detailed architecture diagram
cat > docs/architecture.md << 'EOF'
# System Architecture

## Overview
Architecture showing the key components and data flow for the Guideline Ingest API with proper separation of concerns.

```mermaid
graph TB
    %% Client Layer
    Client[ðŸŒ Client Application]
    
    %% API Gateway
    Gateway[ðŸšª API Gateway]
    
    %% Django Application
    subgraph "ðŸ Django API Server"
        Views[ðŸŽ¯ API Views]
        Models[ðŸ—ƒï¸ Django Models]
        Serializers[ðŸ“ DRF Serializers]
    end
    
    %% Queue System
    subgraph "ðŸ“¬ Job Queue"
        Redis[(ðŸ”´ Redis Queue)]
        Worker1[âš™ï¸ Celery Worker 1]
        Worker2[âš™ï¸ Celery Worker 2]
    end
    
    %% AI Processing
    subgraph "ðŸ¤– AI Processing"
        GPTSummarizer[ðŸ“ Text Summarizer]
        ChecklistGen[âœ… Checklist Generator]
    end
    
    %% External Services
    OpenAI[ðŸ”® OpenAI API]
    
    %% Database
    Database[(ðŸ’¾ PostgreSQL)]
    
    %% Documentation
    Swagger[ðŸ“š API Docs]
    
    %% Request Flow
    Client -->|POST guideline| Gateway
    Gateway --> Views
    Views --> Serializers
    Serializers --> Models
    Models --> Database
    Views -->|Queue task| Redis
    Views -->|Return event_id <200ms| Client
    
    %% Background Processing
    Redis --> Worker1
    Redis --> Worker2
    Worker1 --> GPTSummarizer
    Worker2 --> GPTSummarizer
    GPTSummarizer -->|API call| OpenAI
    OpenAI --> ChecklistGen
    ChecklistGen -->|Save results| Models
    
    %% Status Check
    Client -->|GET status| Gateway
    Gateway --> Views
    Views -->|Query DB| Database
    Views -->|Return results| Client
    
    %% Documentation
    Views --> Swagger
    
    %% Styling
    classDef client fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef api fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef queue fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef ai fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef external fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef db fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef docs fill:#fafafa,stroke:#616161,stroke-width:2px
    
    class Client client
    class Gateway,Views,Models,Serializers api
    class Redis,Worker1,Worker2 queue
    class GPTSummarizer,ChecklistGen ai
    class OpenAI external
    class Database db
    class Swagger docs